# Generated by Django 4.2.7 on 2025-10-08 08:39

from decimal import Decimal
from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ("accounting", "0001_initial"),
        ("core", "0001_initial"),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name="Tiers",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("code", models.CharField(db_index=True, max_length=20)),
                (
                    "type_tiers",
                    models.CharField(
                        choices=[
                            ("CLIENT", "Client"),
                            ("FOURNISSEUR", "Fournisseur"),
                            ("CLIENT_FOURNISSEUR", "Client et Fournisseur"),
                            ("SALARIE", "Salarié"),
                            ("BANQUE", "Banque"),
                            ("ORGANISME_SOCIAL", "Organisme Social"),
                            ("ADMINISTRATION", "Administration"),
                            ("AUTRE", "Autre"),
                        ],
                        max_length=20,
                    ),
                ),
                ("raison_sociale", models.CharField(max_length=200)),
                (
                    "nom_commercial",
                    models.CharField(blank=True, max_length=200, null=True),
                ),
                ("sigle", models.CharField(blank=True, max_length=50, null=True)),
                (
                    "forme_juridique",
                    models.CharField(
                        blank=True,
                        choices=[
                            ("SA", "Société Anonyme"),
                            ("SARL", "Société à Responsabilité Limitée"),
                            ("SAS", "Société par Actions Simplifiée"),
                            ("SASU", "Société par Actions Simplifiée Unipersonnelle"),
                            (
                                "EURL",
                                "Entreprise Unipersonnelle à Responsabilité Limitée",
                            ),
                            ("EI", "Entreprise Individuelle"),
                            (
                                "EIRL",
                                "Entreprise Individuelle à Responsabilité Limitée",
                            ),
                            ("SNC", "Société en Nom Collectif"),
                            ("SCS", "Société en Commandite Simple"),
                            ("SCA", "Société en Commandite par Actions"),
                            ("GIE", "Groupement d'Intérêt Économique"),
                            ("ASSOCIATION", "Association"),
                            ("COOPERATIVE", "Coopérative"),
                            ("AUTRE", "Autre"),
                        ],
                        max_length=20,
                        null=True,
                    ),
                ),
                (
                    "rccm",
                    models.CharField(
                        blank=True, max_length=50, null=True, verbose_name="RCCM"
                    ),
                ),
                (
                    "nif",
                    models.CharField(
                        blank=True, max_length=50, null=True, verbose_name="NIF"
                    ),
                ),
                (
                    "niu",
                    models.CharField(
                        blank=True, max_length=50, null=True, verbose_name="NIU"
                    ),
                ),
                (
                    "numero_tva",
                    models.CharField(
                        blank=True, max_length=50, null=True, verbose_name="Numéro TVA"
                    ),
                ),
                ("email", models.EmailField(blank=True, max_length=254, null=True)),
                ("telephone", models.CharField(blank=True, max_length=20, null=True)),
                ("mobile", models.CharField(blank=True, max_length=20, null=True)),
                ("fax", models.CharField(blank=True, max_length=20, null=True)),
                ("site_web", models.URLField(blank=True, null=True)),
                (
                    "conditions_paiement",
                    models.PositiveIntegerField(
                        default=30, verbose_name="Conditions de paiement (jours)"
                    ),
                ),
                (
                    "mode_reglement",
                    models.CharField(
                        choices=[
                            ("ESPECES", "Espèces"),
                            ("CHEQUE", "Chèque"),
                            ("VIREMENT", "Virement bancaire"),
                            ("PRELEVEMENT", "Prélèvement"),
                            ("CARTE", "Carte bancaire"),
                            ("TRAITE", "Traite"),
                            ("EFFET_COMMERCE", "Effet de commerce"),
                            ("COMPENSATION", "Compensation"),
                            ("AUTRE", "Autre"),
                        ],
                        default="VIREMENT",
                        max_length=20,
                    ),
                ),
                (
                    "limite_credit",
                    models.DecimalField(
                        decimal_places=2,
                        default=0,
                        max_digits=15,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0"))
                        ],
                    ),
                ),
                (
                    "plafond_escompte",
                    models.DecimalField(
                        decimal_places=2,
                        default=0,
                        max_digits=15,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0"))
                        ],
                    ),
                ),
                (
                    "taux_remise",
                    models.DecimalField(
                        decimal_places=2,
                        default=0,
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                    ),
                ),
                (
                    "taux_escompte",
                    models.DecimalField(
                        decimal_places=2,
                        default=0,
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                    ),
                ),
                ("exonere_tva", models.BooleanField(default=False)),
                (
                    "numero_exoneration_tva",
                    models.CharField(blank=True, max_length=50, null=True),
                ),
                ("iban", models.CharField(blank=True, max_length=34, null=True)),
                ("bic", models.CharField(blank=True, max_length=11, null=True)),
                (
                    "domiciliation",
                    models.CharField(blank=True, max_length=200, null=True),
                ),
                (
                    "score_credit",
                    models.PositiveIntegerField(
                        default=100,
                        validators=[
                            django.core.validators.MinValueValidator(0),
                            django.core.validators.MaxValueValidator(1000),
                        ],
                    ),
                ),
                (
                    "encours_actuel",
                    models.DecimalField(
                        decimal_places=2, default=0, editable=False, max_digits=15
                    ),
                ),
                (
                    "retard_moyen",
                    models.PositiveIntegerField(default=0, editable=False),
                ),
                (
                    "statut",
                    models.CharField(
                        choices=[
                            ("ACTIF", "Actif"),
                            ("BLOQUE", "Bloqué"),
                            ("SUSPENDU", "Suspendu"),
                            ("ARCHIVE", "Archivé"),
                        ],
                        default="ACTIF",
                        max_length=20,
                    ),
                ),
                ("motif_blocage", models.TextField(blank=True, null=True)),
                ("date_blocage", models.DateTimeField(blank=True, null=True)),
                (
                    "secteur_activite",
                    models.CharField(blank=True, max_length=100, null=True),
                ),
                ("effectif", models.PositiveIntegerField(blank=True, null=True)),
                (
                    "capital",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=15,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0"))
                        ],
                    ),
                ),
                (
                    "chiffre_affaires",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        max_digits=15,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0"))
                        ],
                    ),
                ),
                ("date_creation_entreprise", models.DateField(blank=True, null=True)),
                ("date_premiere_relation", models.DateField(blank=True, null=True)),
                (
                    "date_derniere_commande",
                    models.DateField(blank=True, editable=False, null=True),
                ),
                (
                    "date_dernier_paiement",
                    models.DateField(blank=True, editable=False, null=True),
                ),
                ("observations", models.TextField(blank=True, null=True)),
                ("tags", models.JSONField(blank=True, default=list)),
                (
                    "bloque_par",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="tiers_bloques",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "compte_client",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="tiers_clients",
                        to="accounting.chartofaccounts",
                        verbose_name="Compte client",
                    ),
                ),
                (
                    "compte_fournisseur",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="tiers_fournisseurs",
                        to="accounting.chartofaccounts",
                        verbose_name="Compte fournisseur",
                    ),
                ),
                (
                    "devise",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.PROTECT, to="core.devise"
                    ),
                ),
                (
                    "societe",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="tiers",
                        to="core.societe",
                    ),
                ),
            ],
            options={
                "verbose_name": "Tiers",
                "verbose_name_plural": "Tiers",
                "db_table": "third_party_tiers",
            },
        ),
        migrations.CreateModel(
            name="HistoriqueTiers",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "action",
                    models.CharField(
                        choices=[
                            ("CREATE", "Création"),
                            ("UPDATE", "Modification"),
                            ("BLOCK", "Blocage"),
                            ("UNBLOCK", "Déblocage"),
                            ("ARCHIVE", "Archivage"),
                            ("REACTIVATE", "Réactivation"),
                            ("CREDIT_LIMIT_CHANGE", "Modification limite crédit"),
                            ("STATUS_CHANGE", "Changement statut"),
                        ],
                        max_length=20,
                    ),
                ),
                ("description", models.TextField()),
                ("anciennes_valeurs", models.JSONField(blank=True, null=True)),
                ("nouvelles_valeurs", models.JSONField(blank=True, null=True)),
                ("date_action", models.DateTimeField(auto_now_add=True)),
                ("adresse_ip", models.GenericIPAddressField(blank=True, null=True)),
                (
                    "tiers",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="historique",
                        to="third_party.tiers",
                    ),
                ),
                (
                    "utilisateur",
                    models.ForeignKey(
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Historique",
                "verbose_name_plural": "Historiques",
                "db_table": "third_party_historique",
                "ordering": ["-date_action"],
            },
        ),
        migrations.CreateModel(
            name="ContactTiers",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "civilite",
                    models.CharField(
                        blank=True,
                        choices=[("M", "Monsieur"), ("MME", "Madame")],
                        max_length=10,
                        null=True,
                    ),
                ),
                ("nom", models.CharField(max_length=100)),
                ("prenom", models.CharField(blank=True, max_length=100, null=True)),
                (
                    "fonction",
                    models.CharField(
                        choices=[
                            ("DIRIGEANT", "Dirigeant"),
                            ("COMPTABLE", "Comptable"),
                            ("ACHETEUR", "Acheteur"),
                            ("VENDEUR", "Commercial"),
                            ("TECHNIQUE", "Contact technique"),
                            ("JURIDIQUE", "Contact juridique"),
                            ("AUTRE", "Autre"),
                        ],
                        max_length=20,
                    ),
                ),
                ("titre", models.CharField(blank=True, max_length=100, null=True)),
                (
                    "telephone_fixe",
                    models.CharField(blank=True, max_length=20, null=True),
                ),
                (
                    "telephone_mobile",
                    models.CharField(blank=True, max_length=20, null=True),
                ),
                ("email", models.EmailField(blank=True, max_length=254, null=True)),
                (
                    "preference_contact",
                    models.CharField(
                        choices=[
                            ("EMAIL", "Email"),
                            ("TELEPHONE", "Téléphone"),
                            ("COURRIER", "Courrier"),
                        ],
                        default="EMAIL",
                        max_length=20,
                    ),
                ),
                ("is_principal", models.BooleanField(default=False)),
                ("is_active", models.BooleanField(default=True)),
                ("observations", models.TextField(blank=True, null=True)),
                (
                    "tiers",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="contacts",
                        to="third_party.tiers",
                    ),
                ),
            ],
            options={
                "verbose_name": "Contact",
                "verbose_name_plural": "Contacts",
                "db_table": "third_party_contact",
            },
        ),
        migrations.CreateModel(
            name="ClassificationTiers",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "type_classification",
                    models.CharField(
                        choices=[
                            ("SECTEUR", "Secteur d'activité"),
                            ("TAILLE", "Taille"),
                            ("REGION", "Région géographique"),
                            ("COMMERCIAL", "Classification commerciale"),
                            ("RISQUE", "Niveau de risque"),
                            ("AUTRE", "Autre"),
                        ],
                        max_length=20,
                    ),
                ),
                ("valeur", models.CharField(max_length=100)),
                ("description", models.TextField(blank=True, null=True)),
                ("date_debut", models.DateField(blank=True, null=True)),
                ("date_fin", models.DateField(blank=True, null=True)),
                (
                    "tiers",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="classifications",
                        to="third_party.tiers",
                    ),
                ),
            ],
            options={
                "verbose_name": "Classification",
                "verbose_name_plural": "Classifications",
                "db_table": "third_party_classification",
            },
        ),
        migrations.CreateModel(
            name="CategorieAnalytique",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("code", models.CharField(db_index=True, max_length=20)),
                ("libelle", models.CharField(max_length=100)),
                ("description", models.TextField(blank=True, null=True)),
                ("is_active", models.BooleanField(default=True)),
                (
                    "societe",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="categories_tiers",
                        to="core.societe",
                    ),
                ),
            ],
            options={
                "verbose_name": "Catégorie analytique",
                "verbose_name_plural": "Catégories analytiques",
                "db_table": "third_party_categorie",
            },
        ),
        migrations.CreateModel(
            name="AdresseTiers",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "type_adresse",
                    models.CharField(
                        choices=[
                            ("PRINCIPALE", "Adresse principale"),
                            ("FACTURATION", "Adresse de facturation"),
                            ("LIVRAISON", "Adresse de livraison"),
                            ("COURRIER", "Adresse de courrier"),
                            ("AUTRE", "Autre"),
                        ],
                        max_length=20,
                    ),
                ),
                ("libelle", models.CharField(blank=True, max_length=100, null=True)),
                ("ligne1", models.CharField(max_length=100)),
                ("ligne2", models.CharField(blank=True, max_length=100, null=True)),
                ("ligne3", models.CharField(blank=True, max_length=100, null=True)),
                ("code_postal", models.CharField(blank=True, max_length=10, null=True)),
                ("ville", models.CharField(max_length=100)),
                ("region", models.CharField(blank=True, max_length=100, null=True)),
                ("pays", models.CharField(default="Cameroun", max_length=100)),
                (
                    "latitude",
                    models.DecimalField(
                        blank=True, decimal_places=8, max_digits=10, null=True
                    ),
                ),
                (
                    "longitude",
                    models.DecimalField(
                        blank=True, decimal_places=8, max_digits=11, null=True
                    ),
                ),
                ("telephone", models.CharField(blank=True, max_length=20, null=True)),
                ("email", models.EmailField(blank=True, max_length=254, null=True)),
                ("is_default", models.BooleanField(default=False)),
                ("is_active", models.BooleanField(default=True)),
                (
                    "tiers",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="adresses",
                        to="third_party.tiers",
                    ),
                ),
            ],
            options={
                "verbose_name": "Adresse",
                "verbose_name_plural": "Adresses",
                "db_table": "third_party_adresse",
            },
        ),
        migrations.AddIndex(
            model_name="tiers",
            index=models.Index(
                fields=["societe", "type_tiers"], name="third_party_societe_e614b9_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="tiers",
            index=models.Index(
                fields=["societe", "statut"], name="third_party_societe_c167f4_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="tiers",
            index=models.Index(
                fields=["raison_sociale"], name="third_party_raison__305b4a_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="tiers",
            index=models.Index(fields=["nif"], name="third_party_nif_fe2a29_idx"),
        ),
        migrations.AddIndex(
            model_name="tiers",
            index=models.Index(fields=["rccm"], name="third_party_rccm_45091f_idx"),
        ),
        migrations.AddIndex(
            model_name="tiers",
            index=models.Index(
                fields=["created_at"], name="third_party_created_09a9e3_idx"
            ),
        ),
        migrations.AlterUniqueTogether(
            name="tiers",
            unique_together={("societe", "code")},
        ),
        migrations.AlterUniqueTogether(
            name="classificationtiers",
            unique_together={("tiers", "type_classification")},
        ),
        migrations.AlterUniqueTogether(
            name="categorieanalytique",
            unique_together={("societe", "code")},
        ),
        migrations.AlterUniqueTogether(
            name="adressetiers",
            unique_together={("tiers", "type_adresse", "is_default")},
        ),
    ]
